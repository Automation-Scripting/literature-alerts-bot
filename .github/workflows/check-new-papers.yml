name: arXiv â†’ Discord

on:
  schedule:
    - cron: "0 8 * * *"   # daily at 08:00 UTC = 05:00 BRT (UTC-3)
  workflow_dispatch:
    inputs:
      only_topic:
        description: "Run only this topic id (default: all)"
        required: false
        default: "all"
        type: string
      time_frame:
        description: "Days back (default: 1) or 'all'"
        required: false
        default: "1"
        type: string

jobs:
  run-scripts:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install deps
        run: |
          python -m pip install --upgrade pip
          pip install feedparser requests pyyaml

      - name: Run topics via runner
        env:
          TIME_FRAME: ${{ github.event.inputs.time_frame || '1' }}
          ONLY_TOPIC: ${{ github.event.inputs.only_topic || 'all' }}

          DISCORD_WEBHOOK_URL_HEPPH: ${{ secrets.HEP_PHENOMENOLOGY_HOOK }}
          DISCORD_WEBHOOK_URL_BARYOGENESIS: ${{ secrets.HEP_EARLY_UNIVERSE_BARYOGENESIS_HOOK }}
          DISCORD_WEBHOOK_URL_QGP_LFI: ${{ secrets.HEP_QGP_LIKELIHOOD_FREE_HOOK }}
          DISCORD_WEBHOOK_URL_QGP_ML: ${{ secrets.HEP_QGP_ML_HOOK }}
          DISCORD_WEBHOOK_URL_QGP_NN: ${{ secrets.HEP_QGP_NEURAL_HOOK }}
          DISCORD_WEBHOOK_URL_QGP_BAYESIAN: ${{ secrets.HEP_QGP_BAYESIAN_INFERENCE_HOOK }}
          DISCORD_WEBHOOK_URL_QGP_DKL: ${{ secrets.HEP_QGP_DEEP_KERNEL_LEARNING_HOOK }}
        run: python runner.py topics/hep.yml